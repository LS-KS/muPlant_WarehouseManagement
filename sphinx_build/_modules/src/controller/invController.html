<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>src.controller.invController &#8212; ÂµPlant Warehouse Management 01.10.2023 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for src.controller.invController</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">src.model.DataModel</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">src.constants.Constants</span> <span class="kn">import</span> <span class="n">Constants</span>
<span class="kn">from</span> <span class="nn">src.viewmodel.storageViewModel</span> <span class="kn">import</span> <span class="n">StorageViewModel</span><span class="p">,</span> <span class="n">StorageData</span>
<span class="kn">from</span> <span class="nn">src.viewmodel.productlistViewModel</span> <span class="kn">import</span> <span class="n">ProductListViewModel</span><span class="p">,</span><span class="n">ProductData</span>
<span class="kn">from</span> <span class="nn">src.viewmodel.productSummaryViewModel</span> <span class="kn">import</span> <span class="n">ProductSummaryViewModel</span>
<span class="kn">from</span> <span class="nn">PySide6.QtCore</span> <span class="kn">import</span> <span class="n">Signal</span><span class="p">,</span> <span class="n">Slot</span><span class="p">,</span> <span class="n">QObject</span>
<span class="kn">from</span> <span class="nn">PySide6.QtCore</span> <span class="kn">import</span> <span class="n">Qt</span>

<div class="viewcode-block" id="invController"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController">[docs]</a><span class="k">class</span> <span class="nc">invController</span><span class="p">(</span><span class="n">QObject</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Controller class which gives access to DataModel module to remain consistent Data.</span>

<span class="sd">    :param inventory: holds 2D array of StorageElements which can hold a pallet.</span>
<span class="sd">    :type inventory: DataModel.Inventory</span>

<span class="sd">    :param mobileRobot: represents a mobileRobot in docking station.</span>
<span class="sd">    :type mobileRobot: DataModel.MobileRobot</span>

<span class="sd">    :param gripper: represents gripper on IRB140, can hold either one cup or pallet</span>
<span class="sd">    :type gripper: DataModel.Gripper</span>

<span class="sd">    :param workbench: represents physical workbench with two slots for a pallet.</span>
<span class="sd">    :type workbench: DataModel.Workbench</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Signal can be captured in qml file with Connections - syntax and handling on signal called &#39;onRowClicked&#39;</span>
    <span class="n">transmitStorageData</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
    <span class="n">transmitWorkbenchData</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
    <span class="n">transmitWorkbenchPallet</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="n">transmitMobileRobot</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="n">transmitGripper</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="n">productSelected</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">idSwapped</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        create objects of every DataModel entity which is a physical unit.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inventory</span> <span class="o">=</span> <span class="n">Inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mobileRobot</span> <span class="o">=</span> <span class="n">MobileRobot</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span> <span class="o">=</span> <span class="n">Gripper</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span> <span class="o">=</span> <span class="n">Workbench</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constants</span> <span class="o">=</span> <span class="n">Constants</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">productlistViewModel</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">productSummaryViewModel</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eventlogService</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">productList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__loadData</span><span class="p">()</span>

<div class="viewcode-block" id="invController.selectRow"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.selectRow">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">selectRow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        @Slot(str)</span>
<span class="sd">        Takes a product ID as argument and emits it as signal productSelected.</span>
<span class="sd">        :param message: product id</span>
<span class="sd">        :type message: str</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;selectRow called with message: &quot;</span> <span class="o">+</span> <span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">productSelected</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></div>
<div class="viewcode-block" id="invController.loadStorage"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.loadStorage">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">loadStorage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">slot</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        @Slot(str, str)</span>
<span class="sd">        This method takes data from EditDialog qml file when the user wants to</span>
<span class="sd">        override the storage entry.</span>
<span class="sd">        Decodes Storage ID &#39;L1&#39; to L&#39;18&#39; in row / col and checks for ValueErrors.</span>
<span class="sd">        Uses invControllers transmitData signal to return product, slot, cup ID and productList index.</span>

<span class="sd">        :param storage:</span>
<span class="sd">        :type storage: str</span>
<span class="sd">        :param slot:</span>
<span class="sd">        :type slot: str</span>
<span class="sd">        :return: uses Qt Signal object to return productslot, cup ID and productListIndex.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">storage</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">storage</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="c1"># extracts the integer from storage string</span>
            <span class="n">row</span> <span class="o">=</span> <span class="p">(</span><span class="n">number</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">6</span>
            <span class="n">col</span> <span class="o">=</span> <span class="p">(</span><span class="n">number</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">6</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">row</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error could not decode storage(row)&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error could not decode storage(col)&quot;</span><span class="p">)</span>
            <span class="n">palletRole</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span>
                <span class="n">cupRole</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">2</span>
                <span class="n">prodRole</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">3</span>
            <span class="k">elif</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
                <span class="n">cupRole</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">5</span>
                <span class="n">prodRole</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">6</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Slot Value error. Slot must be &#39;a&#39; or &#39;b&#39;&quot;</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">createIndex</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
            <span class="n">isPallet</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">palletRole</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="kc">False</span>
            <span class="n">product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">prodRole</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;index: </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">, product: </span><span class="si">{</span><span class="n">product</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">productlistIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productlistViewModel</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
            <span class="n">cup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">cupRole</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transmitStorageData</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">slot</span><span class="p">,</span> <span class="n">cup</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span> <span class="n">isPallet</span><span class="p">)</span></div>
<div class="viewcode-block" id="invController.loadWorkbench"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.loadWorkbench">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">loadWorkbench</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">slot</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        @Slot(str, int, int, bool)</span>
<span class="sd">        This method takes data from WorkbenchDialog.qml file when the user wants to mauallY</span>
<span class="sd">        override the workbench entry.</span>
<span class="sd">        Uses invControllers transmitWorkbenchData signal to return product, slot, cup ID and productList index.</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">storage</span> <span class="o">==</span> <span class="s2">&quot;K1&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">isPallet</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span>
                    <span class="n">cupID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">slotA</span>
                    <span class="n">productID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">slotA</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">id</span>
                <span class="k">elif</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
                    <span class="n">cupID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">slotB</span>
                    <span class="n">productID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">slotB</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">id</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Slot Value error. Slot must be &#39;a&#39; or &#39;b&#39;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cupID</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">productID</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">isPallet</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">storage</span> <span class="o">==</span> <span class="s2">&quot;K2&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">isPallet</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span>
                    <span class="n">cupID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">slotA</span>
                    <span class="n">productID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">slotA</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">getID</span><span class="p">()</span>
                <span class="k">elif</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
                    <span class="n">cupID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">slotB</span>
                    <span class="n">productID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">slotB</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">getID</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Slot Value error. Slot must be &#39;a&#39; or &#39;b&#39;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cupID</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">productID</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">isPallet</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Storage Value error. Storage must be &#39;K1&#39; or &#39;K2&#39;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transmitWorkbenchData</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">cupID</span><span class="p">,</span> <span class="n">productID</span><span class="p">,</span> <span class="n">isPallet</span><span class="p">)</span></div>
<div class="viewcode-block" id="invController.changeGripper"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.changeGripper">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">changeGripper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">isPallet</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">isCup</span><span class="p">:</span><span class="nb">bool</span><span class="p">,</span> <span class="n">cupAID</span> <span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">productAID</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">cupBID</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">productBID</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        @Slot(bool, bool, int, int, int, int)</span>
<span class="sd">        This method takes data from manual gripper override in EditDialog.qml.</span>
<span class="sd">        When grippers object is changed, it emits its signal objectChanged to update ProcessView.</span>
<span class="sd">        Sets grippers object to None if isPallet and isCup are False.</span>
<span class="sd">        :param isPallet: True if the changed data refers to a pallet, else False</span>
<span class="sd">        :type isPallet: bool</span>
<span class="sd">        :param isCup: True if the changed data refers to a cup, else False</span>
<span class="sd">        :type isCup: bool</span>
<span class="sd">        :param cupAID: either ID from Cup A if transmitted object shall be an Pallet object or cupID.</span>
<span class="sd">        :type cupAID: int</span>
<span class="sd">        :param productAID: either ID from Product A if transmitted object shall be an Pallet object or productID.</span>
<span class="sd">        :param cupBID: Cup-ID from Cup B if transmitted object shall be an Pallet object, else 0.</span>
<span class="sd">        :type cupBID: int</span>
<span class="sd">        :param productBID: Product-ID from Product B if transmitted object shall be an Pallet object, else 0.</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">isPallet</span><span class="p">:</span>
            <span class="n">pallet</span> <span class="o">=</span> <span class="n">Pallet</span><span class="p">()</span>
            <span class="n">pallet</span><span class="o">.</span><span class="n">setSlotA</span><span class="p">(</span><span class="n">Cup</span><span class="p">(</span><span class="n">cupAID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="n">productAID</span><span class="p">)))</span>
            <span class="n">pallet</span><span class="o">.</span><span class="n">setSlotB</span><span class="p">(</span><span class="n">Cup</span><span class="p">(</span><span class="n">cupBID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="n">productBID</span><span class="p">)))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">object</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">setObject</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">setObject</span><span class="p">(</span><span class="n">pallet</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">isCup</span><span class="p">:</span>
            <span class="n">cup</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">cupAID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="n">productAID</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">setObject</span><span class="p">(</span><span class="n">cup</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">setObject</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">productAName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="n">productAID</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
        <span class="n">productBName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="n">productBID</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transmitGripper</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">isPallet</span><span class="p">,</span> <span class="n">isCup</span><span class="p">,</span> <span class="n">cupAID</span><span class="p">,</span> <span class="n">productAID</span><span class="p">,</span> <span class="n">productAName</span><span class="p">,</span> <span class="n">cupBID</span><span class="p">,</span> <span class="n">productBID</span><span class="p">,</span> <span class="n">productBName</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eventlogService</span><span class="o">.</span><span class="n">writeEvent</span><span class="p">(</span><span class="s2">&quot;Gripper&quot;</span><span class="p">,</span>
                                        <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">*** ATTENTION ***</span><span class="se">\n\n</span><span class="s2">!!! GRIPPER OVERRIDE !!!</span><span class="se">\n\n</span><span class="s2">Location: Gripper</span><span class="se">\n\n</span><span class="s2">*** DANGER ***</span><span class="se">\n\n</span><span class="s2">The storage information provided might be incorrect. As a result, the robotic arm will move recklessly, posing a severe risk to human life. There is a high possibility of crashes and flying parts that can cause serious injuries or fatalities.</span><span class="se">\n\n</span><span class="s2">*** THIS IS A LIFE-THREATENING SITUATION ***</span><span class="se">\n\n</span><span class="s2">&gt;&gt;&gt;&gt;&gt; CHANGES ARE PERMANENT &lt;&lt;&lt;&lt;&lt;</span><span class="se">\n\n</span><span class="s2">_____</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="invController.loadGripper"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.loadGripper">[docs]</a>    <span class="nd">@Slot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">loadGripper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        @Slot()</span>
<span class="sd">        emits transmitGripper signal to update ProcessView although no data is changed.</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">object</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">isPallet</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">Pallet</span><span class="p">)</span>
            <span class="n">isCup</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">Cup</span><span class="p">)</span>
            <span class="n">cupAID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">slotA</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="n">isPallet</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">id</span>
            <span class="n">productAID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">slotA</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="n">isPallet</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">id</span>
            <span class="n">productAName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">slotA</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">isPallet</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">name</span>
            <span class="n">cupBID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">slotB</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="n">isPallet</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">productBID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">slotB</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="n">isPallet</span> <span class="k">else</span> <span class="mi">0</span>
            <span class="n">productBName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">slotB</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">isPallet</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;loadGripper: </span><span class="si">{</span><span class="n">isPallet</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">isCup</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">cupAID</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">productAID</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">productAName</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">cupBID</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">productBID</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">productBName</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transmitGripper</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">isPallet</span><span class="p">,</span> <span class="n">isCup</span><span class="p">,</span> <span class="n">cupAID</span><span class="p">,</span> <span class="n">productAID</span><span class="p">,</span> <span class="n">productAName</span><span class="p">,</span> <span class="n">cupBID</span><span class="p">,</span> <span class="n">productBID</span><span class="p">,</span> <span class="n">productBName</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;loadGripper: False, False, 0, 0, &#39;&#39;, 0, 0, &#39;&#39;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transmitGripper</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="invController.changeStorage"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.changeStorage">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">changeStorage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage</span><span class="p">,</span> <span class="n">slot</span><span class="p">,</span> <span class="n">cupID</span><span class="p">,</span> <span class="n">productID</span><span class="p">,</span> <span class="n">palletPresent</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        @Slot(str, str, int, int)</span>
<span class="sd">        This method takes data from manual storage override in EditDialog.qml.</span>
<span class="sd">        Decodes Storage ID &#39;L1&#39; to L&#39;18&#39; in row / col and checks for ValueErrors.</span>
<span class="sd">        checks if the inventory must be changed and performs the change.</span>
<span class="sd">        Erases data if isPallet is False.</span>
<span class="sd">        Changes StorageViewModel object of invController and calls _dumpStorage() to save</span>
<span class="sd">        changes to file.</span>

<span class="sd">        :param storage: String like &quot;L17&quot;</span>
<span class="sd">        :type storage: str</span>
<span class="sd">        :param slot: palette slot &#39;a&#39; (front) or &#39;b&#39; (rear)</span>
<span class="sd">        :type slot: str</span>
<span class="sd">        :param cupID: cup ID</span>
<span class="sd">        :type cupID: int</span>
<span class="sd">        :param productID: product ID</span>
<span class="sd">        :type productID: int</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">storage</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">row</span> <span class="o">=</span> <span class="p">(</span><span class="n">number</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">6</span>
        <span class="n">col</span> <span class="o">=</span> <span class="p">(</span><span class="n">number</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">6</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">row</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error could not decode storage(row)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">col</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error could not decode storage(col)&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">palletPresent</span> <span class="o">==</span> <span class="s2">&quot;Yes&quot;</span><span class="p">:</span>
            <span class="n">isPallet</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="n">palletPresent</span> <span class="o">==</span> <span class="s2">&quot;No&quot;</span><span class="p">:</span>
            <span class="n">isPallet</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Error could not decode palletPresent&quot;</span><span class="p">)</span>
        <span class="n">pallet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">getStoragePallet</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">isPallet</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pallet</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">pallet</span> <span class="o">=</span> <span class="n">Pallet</span><span class="p">()</span>
                <span class="n">pallet</span><span class="o">.</span><span class="n">setSlotA</span><span class="p">(</span><span class="n">Cup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
                <span class="n">pallet</span><span class="o">.</span><span class="n">setSlotB</span><span class="p">(</span><span class="n">Cup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">setStoragePallet</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">pallet</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span>
                <span class="n">oldproductID</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotA</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">id</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;to set storage: row: </span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2">, col: </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">, cup: </span><span class="si">{</span><span class="n">cupID</span><span class="si">}</span><span class="s2">, slot: </span><span class="si">{</span><span class="n">slot</span><span class="si">}</span><span class="s2">, product: </span><span class="si">{</span><span class="n">productID</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">roleCup</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">2</span>
                <span class="n">roleProduct</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">3</span>
                <span class="n">roleName</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">4</span>
                <span class="n">cup_obj</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotA</span>
            <span class="k">elif</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
                <span class="n">oldproductID</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotB</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">id</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;to set storage: row: </span><span class="si">{</span><span class="n">row</span><span class="si">}</span><span class="s2">, col: </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">, cup: </span><span class="si">{</span><span class="n">cupID</span><span class="si">}</span><span class="s2">, slot: </span><span class="si">{</span><span class="n">slot</span><span class="si">}</span><span class="s2">, product: </span><span class="si">{</span><span class="n">productID</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">roleCup</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">5</span>
                <span class="n">roleProduct</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">6</span>
                <span class="n">roleName</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">7</span>
                <span class="n">cup_obj</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotB</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Slot Value error. Slot must be &#39;a&#39; or &#39;b&#39;&quot;</span><span class="p">)</span>
            <span class="n">prod_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="n">productID</span><span class="p">)</span>
            <span class="n">cup_obj</span><span class="o">.</span><span class="n">setProduct</span><span class="p">(</span><span class="n">prod_obj</span><span class="p">)</span>
            <span class="n">cup_obj</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="n">cupID</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">createIndex</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
            <span class="n">cup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">cupID</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">roleCup</span><span class="p">)</span>
            <span class="n">product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">productID</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">roleProduct</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">findProductName</span><span class="p">(</span><span class="n">productID</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="n">roleName</span><span class="p">)</span>
            <span class="n">rolePallet</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">pallet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">isPallet</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">rolePallet</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">dataChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="p">[</span><span class="n">roleCup</span><span class="p">,</span> <span class="n">roleProduct</span><span class="p">,</span> <span class="n">roleName</span><span class="p">,</span> <span class="n">rolePallet</span> <span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">idSwapped</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">product</span><span class="p">,</span> <span class="n">productID</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eventlogService</span><span class="o">.</span><span class="n">writeEvent</span><span class="p">(</span><span class="s2">&quot;USER&quot;</span><span class="p">,</span>
                                            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">*** ATTENTION ***</span><span class="se">\n\n</span><span class="s2">!!! INVENTORY OVERRIDE !!!</span><span class="se">\n\n</span><span class="s2">Location: </span><span class="si">{</span><span class="n">storage</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">slot</span><span class="si">}</span><span class="se">\n</span><span class="s2">Cup: </span><span class="si">{</span><span class="n">cup</span><span class="si">}</span><span class="s2"> --&gt; </span><span class="si">{</span><span class="n">cupID</span><span class="si">}</span><span class="se">\n</span><span class="s2">Product: </span><span class="si">{</span><span class="n">product</span><span class="si">}</span><span class="s2"> --&gt; </span><span class="si">{</span><span class="n">productID</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">*** DANGER ***</span><span class="se">\n\n</span><span class="s2">The storage information provided might be incorrect. As a result, the robotic arm will move recklessly, posing a severe risk to human life. There is a high possibility of crashes and flying parts that can cause serious injuries or fatalities.</span><span class="se">\n\n</span><span class="s2">*** THIS IS A LIFE-THREATENING SITUATION ***</span><span class="se">\n\n</span><span class="s2">&gt;&gt;&gt;&gt;&gt; CHANGES ARE PERMANENT &lt;&lt;&lt;&lt;&lt;</span><span class="se">\n\n</span><span class="s2">_____</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">oldIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productlistViewModel</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="n">oldproductID</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">productlistViewModel</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">oldIndex</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">newIndex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">productlistViewModel</span><span class="o">.</span><span class="n">indexOf</span><span class="p">(</span><span class="n">productID</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">productlistViewModel</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">newIndex</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">pallet</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">cupA</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotA</span>
            <span class="n">cupA</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">withoutCup</span><span class="p">(</span><span class="n">cupA</span><span class="p">)</span>
            <span class="n">pallet</span><span class="o">.</span><span class="n">setSlotA</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">cupA</span>
            <span class="n">cupB</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotB</span>
            <span class="n">cupB</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">withoutCup</span><span class="p">(</span><span class="n">cupB</span><span class="p">)</span>
            <span class="n">pallet</span><span class="o">.</span><span class="n">setSlotB</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">cupB</span>
            <span class="k">del</span> <span class="n">pallet</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">createIndex</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
            <span class="n">roleCupA</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">2</span>
            <span class="n">roleProductA</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">3</span>
            <span class="n">roleNameA</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">4</span>
            <span class="n">rolePallet</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">cupA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">roleCupA</span><span class="p">)</span>
            <span class="n">productA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">nameA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">findProductName</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
            <span class="n">pallet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">isPallet</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">rolePallet</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">dataChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="p">[</span><span class="n">roleCupA</span><span class="p">,</span> <span class="n">roleProductA</span><span class="p">,</span> <span class="n">roleNameA</span><span class="p">,</span> <span class="n">rolePallet</span><span class="p">])</span>
            <span class="n">roleCupB</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">5</span>
            <span class="n">roleProductB</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">6</span>
            <span class="n">roleNameB</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">7</span>
            <span class="n">cupB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">roleCupB</span><span class="p">)</span>
            <span class="n">productB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">role</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>
            <span class="n">nameB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">findProductName</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="n">Qt</span><span class="o">.</span><span class="n">UserRole</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">dataChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="p">[</span><span class="n">roleCupB</span><span class="p">,</span> <span class="n">roleProductB</span><span class="p">,</span> <span class="n">roleNameB</span><span class="p">,</span> <span class="n">rolePallet</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dumpStorage</span><span class="p">()</span></div>
<div class="viewcode-block" id="invController.changeWorkbench"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.changeWorkbench">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">changeWorkbench</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">storage</span><span class="p">,</span> <span class="n">slot</span><span class="p">,</span> <span class="n">cupID</span><span class="p">,</span> <span class="n">productID</span><span class="p">,</span> <span class="n">isPallet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method changes workbench entry depending on submitted storage.</span>
<span class="sd">        gets the pallet object stored in submitted storage and changes the cup object depending on submitted parameters</span>
<span class="sd">        slot, cupID, productID and isPallet. If isPallet is False, cup object is set to None and sets product of cup object to None.</span>
<span class="sd">        Writes message to eventlogService.</span>
<span class="sd">        Calls _dumpStorage() to save changes to file.</span>
<span class="sd">        :param storage: can be &#39;K1&#39; or &#39;K2&#39;</span>
<span class="sd">        :param slot: can be &#39;a&#39; or &#39;b&#39;</span>
<span class="sd">        :type slot: str</span>
<span class="sd">        :param cupID:</span>
<span class="sd">        :type cupID: int</span>
<span class="sd">        :param productID:</span>
<span class="sd">        :type productID: int</span>
<span class="sd">        :param isPallet:</span>
<span class="sd">        :type isPallet: bool</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;to set workbench: storage: </span><span class="si">{</span><span class="n">storage</span><span class="si">}</span><span class="s2">, slot: </span><span class="si">{</span><span class="n">slot</span><span class="si">}</span><span class="s2">, cup: </span><span class="si">{</span><span class="n">cupID</span><span class="si">}</span><span class="s2">, product: </span><span class="si">{</span><span class="n">productID</span><span class="si">}</span><span class="s2">, isPallet: </span><span class="si">{</span><span class="n">isPallet</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">storage</span> <span class="o">==</span> <span class="s2">&quot;K1&quot;</span><span class="p">:</span>
            <span class="n">pallet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span>
            <span class="k">if</span> <span class="n">pallet</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cup_objA</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotA</span> <span class="k">if</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotA</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Cup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                <span class="n">cup_objB</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotB</span> <span class="k">if</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotB</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Cup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">elif</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Slot Value error. Slot must be &#39;a&#39; or &#39;b&#39;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pallet</span> <span class="o">=</span> <span class="n">Pallet</span><span class="p">()</span>
                <span class="n">cup_objA</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                <span class="n">cup_objB</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">storage</span> <span class="o">==</span> <span class="s2">&quot;K2&quot;</span><span class="p">:</span>
            <span class="n">pallet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span>
            <span class="k">if</span> <span class="n">pallet</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cup_objA</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotA</span> <span class="k">if</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotA</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Cup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                <span class="n">cup_objB</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotB</span> <span class="k">if</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotB</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">Cup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">elif</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Slot Value error. Slot must be &#39;a&#39; or &#39;b&#39;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pallet</span> <span class="o">=</span> <span class="n">Pallet</span><span class="p">()</span>
                <span class="n">cup_objA</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
                <span class="n">cup_objB</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Storage Value error. Storage must be &#39;K1&#39; or &#39;K2&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isPallet</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span>
                <span class="n">cup_objA</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="n">cupID</span><span class="p">)</span>
                <span class="n">cup_objA</span><span class="o">.</span><span class="n">setProduct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="n">productID</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;b&quot;</span><span class="p">:</span>
                <span class="n">cup_objB</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="n">cupID</span><span class="p">)</span>
                <span class="n">cup_objB</span><span class="o">.</span><span class="n">setProduct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="n">productID</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cup_objA</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">cup_objA</span><span class="o">.</span><span class="n">setProduct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="n">cup_objB</span><span class="o">.</span><span class="n">setID</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">cup_objB</span><span class="o">.</span><span class="n">setProduct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">pallet</span><span class="o">.</span><span class="n">setSlotA</span><span class="p">(</span><span class="n">cup_objA</span><span class="p">)</span>
        <span class="n">pallet</span><span class="o">.</span><span class="n">setSlotB</span><span class="p">(</span><span class="n">cup_objB</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">storage</span> <span class="o">==</span> <span class="s2">&quot;K1&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">setK1</span><span class="p">(</span><span class="n">pallet</span><span class="p">)</span>
            <span class="n">cupAID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">slotA</span><span class="o">.</span><span class="n">id</span>
            <span class="n">prodAID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">slotA</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">id</span>
            <span class="n">prodAName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">slotA</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">name</span>
            <span class="n">cupBID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">slotB</span><span class="o">.</span><span class="n">id</span>
            <span class="n">prodBID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">slotB</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">id</span>
            <span class="n">prodBName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">slotB</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">name</span>
        <span class="k">elif</span> <span class="n">storage</span> <span class="o">==</span> <span class="s2">&quot;K2&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">setK2</span><span class="p">(</span><span class="n">pallet</span><span class="p">)</span>
            <span class="n">cupAID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">slotA</span><span class="o">.</span><span class="n">id</span>
            <span class="n">prodAID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">slotA</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">id</span>
            <span class="n">prodAName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">slotA</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">name</span>
            <span class="n">cupBID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">slotB</span><span class="o">.</span><span class="n">id</span>
            <span class="n">prodBID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">slotB</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">id</span>
            <span class="n">prodBName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">slotB</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Storage Value error. Storage must be &#39;K1&#39; or &#39;K2&#39;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transmitWorkbenchPallet</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">storage</span><span class="p">,</span> <span class="n">cupAID</span><span class="p">,</span> <span class="n">prodAID</span><span class="p">,</span> <span class="n">prodAName</span><span class="p">,</span><span class="n">isPallet</span> <span class="p">,</span><span class="n">cupBID</span><span class="p">,</span> <span class="n">prodBID</span><span class="p">,</span> <span class="n">prodBName</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dumpStorage</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;transmitWorkbenchPallet emitted:</span><span class="si">{</span><span class="n">storage</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">cupAID</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">prodAID</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">prodAName</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">isPallet</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">cupBID</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">prodBID</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">prodBName</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eventlogService</span><span class="o">.</span><span class="n">writeEvent</span><span class="p">(</span><span class="s2">&quot;USER&quot;</span><span class="p">,</span>
                                        <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">*** ATTENTION ***</span><span class="se">\n\n</span><span class="s2">!!! INVENTORY OVERRIDE !!!</span><span class="se">\n\n</span><span class="s2">Location: </span><span class="si">{</span><span class="n">storage</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">slot</span><span class="si">}</span><span class="se">\n</span><span class="s2">Cup:--&gt; </span><span class="si">{</span><span class="n">cupID</span><span class="si">}</span><span class="se">\n</span><span class="s2">Product:--&gt; </span><span class="si">{</span><span class="n">productID</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">*** DANGER ***</span><span class="se">\n\n</span><span class="s2">The storage information provided might be incorrect. As a result, the robotic arm will move recklessly, posing a severe risk to human life. There is a high possibility of crashes and flying parts that can cause serious injuries or fatalities.</span><span class="se">\n\n</span><span class="s2">*** THIS IS A LIFE-THREATENING SITUATION ***</span><span class="se">\n\n</span><span class="s2">&gt;&gt;&gt;&gt;&gt; CHANGES ARE PERMANENT &lt;&lt;&lt;&lt;&lt;</span><span class="se">\n\n</span><span class="s2">_____</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="invController.changeMobileRobot"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.changeMobileRobot">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">changeMobileRobot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cupID</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">productID</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        @Slot(int, int)</span>
<span class="sd">        This method takes data from TurtleDialog. It is used to change the mobile robot&#39;s cup and product.</span>
<span class="sd">        Checks the cupID and productID for ValueErrors.</span>
<span class="sd">        Writes changes to inventoryController&#39;s mobile Robot object.</span>
<span class="sd">        Emits transmitMobileRobot signal with data stored in self.mobileRobot cup and product data.</span>
<span class="sd">        Writes an event to the eventlogService.</span>
<span class="sd">        :param cupID:</span>
<span class="sd">        :type cupID: int</span>
<span class="sd">        :param productID:</span>
<span class="sd">        :type productID: int</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oldCup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mobileRobot</span><span class="o">.</span><span class="n">cup</span>
        <span class="k">if</span> <span class="n">oldCup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">oldCup</span><span class="o">.</span><span class="n">setProduct</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">oldCup</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">oldCup</span>
        <span class="n">newCup</span> <span class="o">=</span> <span class="n">Cup</span><span class="p">(</span><span class="n">cupID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="n">productID</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mobileRobot</span><span class="o">.</span><span class="n">setCup</span><span class="p">(</span><span class="n">newCup</span><span class="p">)</span>
        <span class="n">cupID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mobileRobot</span><span class="o">.</span><span class="n">cup</span><span class="o">.</span><span class="n">id</span>
        <span class="n">productID</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mobileRobot</span><span class="o">.</span><span class="n">cup</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">id</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="n">productID</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transmitMobileRobot</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">cupID</span><span class="p">,</span> <span class="n">productID</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;transmitMobileRobot emitted:</span><span class="si">{</span><span class="n">cupID</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">productID</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
<div class="viewcode-block" id="invController.getWorkbenchSlot"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.getWorkbenchSlot">[docs]</a>    <span class="nd">@Slot</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getWorkbenchSlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slot</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        @Slot(str)</span>
<span class="sd">        This method passes workbench data to the GUI.</span>
<span class="sd">        Decodes Slot ID &#39;K1&#39; or &#39;K2&#39; and checks for ValueErrors.</span>
<span class="sd">        Calls transmitWorkbenchPallet signal with data stored in self.workbench.</span>
<span class="sd">        :param slot: Slot &#39;K1&#39; or &#39;K2&#39;</span>
<span class="sd">        :type slot: str</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;getWorkbenchSlot: </span><span class="si">{</span><span class="n">slot</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;K1&quot;</span><span class="p">:</span>
            <span class="n">pallet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">pallet</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cupIDA</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotA</span>
                <span class="n">productIDA</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotA</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">getID</span><span class="p">()</span>
                <span class="n">isPallet</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">cupIDB</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotB</span>
                <span class="n">productIDB</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotB</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">getID</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cupIDA</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">productIDA</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">isPallet</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">cupIDB</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">productIDB</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">slot</span> <span class="o">==</span> <span class="s2">&quot;K2&quot;</span><span class="p">:</span>
            <span class="n">pallet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">pallet</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cupIDA</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotA</span>
                <span class="n">productIDA</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotA</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">getID</span><span class="p">()</span>
                <span class="n">isPallet</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">cupIDB</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotB</span>
                <span class="n">productIDB</span> <span class="o">=</span> <span class="n">pallet</span><span class="o">.</span><span class="n">slotB</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">getID</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cupIDA</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">productIDA</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">isPallet</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">cupIDB</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">productIDB</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Slot Value error. Slot must be &#39;K1&#39; or &#39;K2&#39;&quot;</span><span class="p">)</span>
        <span class="n">productNameA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findProductName</span><span class="p">(</span><span class="n">productIDA</span><span class="p">)</span>
        <span class="n">productNameB</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">findProductName</span><span class="p">(</span><span class="n">productIDB</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;getWorkbenchSlot: </span><span class="si">{</span><span class="n">slot</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">cupIDA</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">productIDA</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">productNameA</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">isPallet</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">cupIDB</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">productIDB</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">productNameB</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transmitWorkbenchPallet</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">slot</span><span class="p">,</span> <span class="n">cupIDA</span><span class="p">,</span> <span class="n">productIDA</span><span class="p">,</span> <span class="n">productNameA</span><span class="p">,</span> <span class="n">isPallet</span><span class="p">,</span> <span class="n">cupIDB</span><span class="p">,</span> <span class="n">productIDB</span><span class="p">,</span> <span class="n">productNameB</span><span class="p">)</span></div>
<div class="viewcode-block" id="invController.movePalletToK1"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.movePalletToK1">[docs]</a>    <span class="k">def</span> <span class="nf">movePalletToK1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pallet</span><span class="p">:</span> <span class="n">Pallet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Moves a pallet to Workbench&#39;s K1 slot.</span>

<span class="sd">        :param pallet: The pallet which shall be transported</span>
<span class="sd">        :type: Pallet object</span>
<span class="sd">        :raises ValueError: if destination is not None</span>
<span class="sd">        :return: True if successful, False if not</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pallet</span><span class="p">,</span> <span class="n">Pallet</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">pallet</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Pallet can not be transprted to K1 because destination is not empty!&quot;</span><span class="p">)</span>
        <span class="n">pallet</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="p">)</span>
        <span class="c1"># ToDo: Hier Kommando an ABB Roboter einfÃ¼gen und warten bis Meldung kommt, dass Kommando ausgefÃ¼hrt wurde.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">setK1</span><span class="p">(</span><span class="n">pallet</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>
<div class="viewcode-block" id="invController.moveCupToK1"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.moveCupToK1">[docs]</a>    <span class="k">def</span> <span class="nf">moveCupToK1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cup</span><span class="p">:</span> <span class="n">Cup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Moves a cup to Workbench&#39;s K1 slot.</span>

<span class="sd">        :param cup: The cup which shall be transported</span>
<span class="sd">        :type: Cup object</span>
<span class="sd">        :raises ValueError: if the destination has no pallet or existing pallet has no empty cup place</span>
<span class="sd">        :return: True if successful</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cup</span><span class="p">,</span> <span class="n">Cup</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">cup</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">slotA</span> <span class="ow">or</span> <span class="n">cup</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">slotB</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">slotA</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">slotB</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Pallet can not be transprted to K1 because destination is not empty!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">setObject</span><span class="p">(</span><span class="n">cup</span><span class="p">)</span>
                <span class="c1"># ToDo: Hier Kommando an ABB Roboter einfÃ¼gen und warten bis Meldung kommt, dass Kommando ausgefÃ¼hrt wurde.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">setSlotB</span><span class="p">(</span><span class="n">cup</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">setObject</span><span class="p">(</span><span class="n">cup</span><span class="p">)</span>
            <span class="c1"># ToDo: Hier Kommando an ABB Roboter einfÃ¼gen und warten bis Meldung kommt, dass Kommando ausgefÃ¼hrt wurde.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k1</span><span class="o">.</span><span class="n">setSlotA</span><span class="p">(</span><span class="n">cup</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span></div>
<div class="viewcode-block" id="invController.movePalletToK2"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.movePalletToK2">[docs]</a>    <span class="k">def</span> <span class="nf">movePalletToK2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pallet</span><span class="p">:</span> <span class="n">Pallet</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Moves a pallet to Workbench&#39;s K2 slot.</span>

<span class="sd">        :param pallet: The pallet which shall be transported</span>
<span class="sd">        :type: Pallet object</span>
<span class="sd">        :return: True if successful, False if not</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pallet</span><span class="p">,</span> <span class="n">Pallet</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">pallet</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Pallet can not be transprted to K2 because destination is not empty!&quot;</span><span class="p">)</span>
        <span class="n">pallet</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="p">)</span>
        <span class="c1"># ToDo: Hier Kommando an ABB Roboter einfÃ¼gen und warten bis Meldung kommt, dass Kommando ausgefÃ¼hrt wurde.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">setK2</span><span class="p">(</span><span class="n">pallet</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>
<div class="viewcode-block" id="invController.moveCupToK2"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.moveCupToK2">[docs]</a>    <span class="k">def</span> <span class="nf">moveCupToK2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cup</span><span class="p">:</span> <span class="n">Cup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Moves a cup to Workbench&#39;s K2 slot.</span>

<span class="sd">        :param cup: The cup which shall be transported</span>
<span class="sd">        :type: Cup object</span>
<span class="sd">        :raises ValueError: if the destination has no pallet or existing pallet has no empty cup place</span>
<span class="sd">        :return: True if successful</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cup</span><span class="p">,</span> <span class="n">Cup</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">slotA</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cup</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">slotA</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">slotB</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cup</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">slotB</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Pallet can not be transprted to K1 because destination is not empty!&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">setObject</span><span class="p">(</span><span class="n">cup</span><span class="p">)</span>
                <span class="c1"># ToDo: Hier Kommando an ABB Roboter einfÃ¼gen und warten bis Meldung kommt, dass Kommando ausgefÃ¼hrt wurde.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">setSlotB</span><span class="p">(</span><span class="n">cup</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">setObject</span><span class="p">(</span><span class="n">cup</span><span class="p">)</span>
            <span class="c1"># ToDo: Hier Kommando an ABB Roboter einfÃ¼gen und warten bis Meldung kommt, dass Kommando ausgefÃ¼hrt wurde.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">workbench</span><span class="o">.</span><span class="n">k2</span><span class="o">.</span><span class="n">setSlotA</span><span class="p">(</span><span class="n">cup</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span></div>
<div class="viewcode-block" id="invController.moveCupToMobileRobot"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.moveCupToMobileRobot">[docs]</a>    <span class="k">def</span> <span class="nf">moveCupToMobileRobot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cup</span><span class="p">:</span><span class="n">Cup</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Moves a Cup object to the mobile Robot</span>
<span class="sd">        not implemented: Creates all necessary commands</span>
<span class="sd">        :param cup:</span>
<span class="sd">        :return: True if transport was successful</span>
<span class="sd">        :raises ValueError: if Mobile Robot is not empty</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mobileRobot</span><span class="o">.</span><span class="n">cup</span> <span class="o">==</span> <span class="n">cup</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mobileRobot</span><span class="o">.</span><span class="n">cup</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mobile Robot is not empty!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">setObject</span><span class="p">(</span><span class="n">cup</span><span class="p">)</span>
        <span class="c1"># ToDo: Hier Kommando an ABB Roboter einfÃ¼gen und warten bis Meldung kommt, dass Kommando ausgefÃ¼hrt wurde.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mobileRobot</span><span class="o">.</span><span class="n">setCup</span><span class="p">(</span><span class="n">cup</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>
<div class="viewcode-block" id="invController.movePalletToStorage"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.movePalletToStorage">[docs]</a>    <span class="k">def</span> <span class="nf">movePalletToStorage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pallet</span><span class="p">:</span> <span class="n">Pallet</span><span class="p">,</span> <span class="n">row</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        places a Pallet object in inventory at given position.</span>
<span class="sd">        not implemented: Creates all necessary commands to ABB controller</span>

<span class="sd">        :param pallet: pallet which shall be transported</span>
<span class="sd">        :type pallet: Pallet</span>
<span class="sd">        :param row:</span>
<span class="sd">        :type row: int</span>
<span class="sd">        :param col:</span>
<span class="sd">        :type col: int</span>
<span class="sd">        :return: True if successful</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">getStoragePallet</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span> <span class="s2">&quot;Target destination is not empty!&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gripper</span><span class="o">.</span><span class="n">setObject</span><span class="p">(</span><span class="n">pallet</span><span class="p">)</span>
            <span class="c1"># ToDo: Hier Kommando an ABB Roboter einfÃ¼gen und warten bis Meldung kommt, dass Kommando ausgefÃ¼hrt wurde.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">setStoragePallet</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">pallet</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span></div>
<div class="viewcode-block" id="invController.findProductName"><a class="viewcode-back" href="../../../modules.html#src.controller.invController.invController.findProductName">[docs]</a>    <span class="k">def</span> <span class="nf">findProductName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method to get product Name from productListModel.</span>
<span class="sd">        It is used to emit the changed name for StorageView.qml</span>
<span class="sd">        :param id:</span>
<span class="sd">        :type id: int</span>
<span class="sd">        :return: product name to corresponding index</span>
<span class="sd">        :rtype str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">product</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productlistViewModel</span><span class="o">.</span><span class="n">products</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">product</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">product</span><span class="o">.</span><span class="n">name</span>
        <span class="k">return</span> <span class="kc">None</span></div>
    <span class="k">def</span> <span class="nf">__loadData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load a productList with product ID and name to have appropriate product data.</span>
<span class="sd">        Load Storage Data from another File to populate pallets array and viemodel</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># load product data from Produkte.db</span>
        <span class="n">productList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__loadProductList</span><span class="p">()</span>

        <span class="c1"># load Inventory from StorageData.db</span>
        <span class="n">storageData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__loadStorageData</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__populateInventory</span><span class="p">(</span><span class="n">storageData</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__populateViewModels</span><span class="p">(</span> <span class="n">storageData</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_dumpStorage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Saves the data from StorageViewModel to file.</span>

<span class="sd">        :return: None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot; Model not set. cannot dump data to file&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">FILE</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">STORAGEDATAWRITE</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8-sig&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">FILE</span><span class="p">:</span>
                    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;# Row,Col:IsPalletPresent:CupID_a,ProductID_a|CupID_b,ProductID_b</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
                        <span class="n">r</span> <span class="o">=</span> <span class="n">row</span>
                        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">6</span><span class="p">):</span>
                            <span class="n">storage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span><span class="o">.</span><span class="n">storageData</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span>
                            <span class="n">c</span> <span class="o">=</span> <span class="n">col</span>
                            <span class="n">p</span> <span class="o">=</span> <span class="n">storage</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="n">cA</span> <span class="o">=</span> <span class="n">storage</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                            <span class="n">pA</span> <span class="o">=</span> <span class="n">storage</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                            <span class="n">cB</span> <span class="o">=</span> <span class="n">storage</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
                            <span class="n">pB</span> <span class="o">=</span> <span class="n">storage</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
                            <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">cA</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">pA</span><span class="si">}</span><span class="s2">|</span><span class="si">{</span><span class="n">cB</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">pB</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;Storagefile not found&quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">FILE</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">FILE</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="c1">#self.eventcontroller.writeEvent(&quot;USER&quot;, f&quot;\n Manual Storage Override saved to local File \n&quot;)</span>
    <span class="k">def</span> <span class="nf">__populateInventory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storageData</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes storageData variable to create pallet objects with corresponding cups and products.</span>

<span class="sd">        :param storageData:</span>
<span class="sd">        :type storageData: List of StorageData objects</span>
<span class="sd">        :param productList: List of all possible products</span>
<span class="sd">        :type productList: List of Product objects</span>
<span class="sd">        :return:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">storageData</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">isPallet</span><span class="p">:</span>
                <span class="n">pallet</span> <span class="o">=</span> <span class="n">Pallet</span><span class="p">()</span>
                <span class="n">pallet</span><span class="o">.</span><span class="n">setSlotA</span><span class="p">(</span><span class="n">Cup</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">a_CupID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">a_ProductID</span><span class="p">)))</span>
                <span class="n">pallet</span><span class="o">.</span><span class="n">setSlotB</span><span class="p">(</span><span class="n">Cup</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">b_CupID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__productFromID</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">b_ProductID</span><span class="p">)))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inventory</span><span class="o">.</span><span class="n">setStoragePallet</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">row</span><span class="p">,</span> <span class="n">element</span><span class="o">.</span><span class="n">col</span><span class="p">,</span> <span class="n">pallet</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__loadStorageData</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">StorageData</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return: storageData</span>
<span class="sd">        :rtype storageData: List of StorageData objects.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FILE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">STORAGEDATA</span>
        <span class="n">storageData</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Open StorageData file and read in lines to list</span>
            <span class="c1"># Avoid u\efeff prefix in data by set encodeing to utf8-8-sig (source: stackoverflow)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8-sig&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="nb">list</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

            <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">list</span> <span class="k">if</span> <span class="n">line</span> <span class="o">!=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">]</span>  <span class="c1"># remove empty lines</span>
            <span class="nb">list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>  <span class="c1"># remove first line</span>

            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
                <span class="n">splitData</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>  <span class="c1"># strip and split to get raw data</span>
                <span class="n">splitData</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">splitData</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
                <span class="n">splitData</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">splitData</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
                <span class="c1"># map the split data to Inevntory Data</span>
                <span class="n">row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splitData</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">col</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splitData</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">isPallet</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">splitData</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span> <span class="k">else</span> <span class="kc">False</span>
                <span class="n">a_CupID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splitData</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">a_ProductID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splitData</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">a_Name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">b_CupID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splitData</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">b_ProductID</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">splitData</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="n">b_Name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="c1"># find matching product strings from actual product list</span>
                <span class="k">for</span> <span class="n">product</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">productList</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">product</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">a_ProductID</span><span class="p">:</span>
                        <span class="n">a_Name</span> <span class="o">=</span> <span class="n">product</span><span class="o">.</span><span class="n">name</span>
                    <span class="k">if</span> <span class="n">product</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">b_ProductID</span><span class="p">:</span>
                        <span class="n">b_Name</span> <span class="o">=</span> <span class="n">product</span><span class="o">.</span><span class="n">name</span>
                    <span class="k">if</span> <span class="n">a_Name</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="n">b_Name</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="c1"># append data to storageData for QAbstractTableModel</span>
                <span class="n">storageData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">StorageData</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">isPallet</span><span class="o">=</span><span class="n">isPallet</span><span class="p">,</span> <span class="n">a_CupID</span><span class="o">=</span><span class="n">a_CupID</span><span class="p">,</span> <span class="n">a_ProductID</span><span class="o">=</span><span class="n">a_ProductID</span><span class="p">,</span>
                                <span class="n">b_CupID</span><span class="o">=</span><span class="n">b_CupID</span><span class="p">,</span> <span class="n">b_ProductID</span><span class="o">=</span><span class="n">b_ProductID</span><span class="p">,</span> <span class="n">a_Name</span><span class="o">=</span><span class="n">a_Name</span><span class="p">,</span> <span class="n">b_Name</span><span class="o">=</span><span class="n">b_Name</span><span class="p">))</span>
                <span class="c1"># print(f&quot;Row: {row}\t Col: {col}\t isPallet: {isPallet}\t Cup_A: {a_CupID}\t ProductA: {a_ProductID}, {a_Name}\t Cup_B: {b_CupID}\t ProductB: {b_ProductID}, {b_Name} &quot;)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: could&#39;t find product list file &#39;StorageData.db&#39;&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: file &#39;StorageData.db&#39; doesn&#39;t exist&quot;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">storageData</span>
    <span class="k">def</span> <span class="nf">__loadProductList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Opens file with path from constants.</span>
<span class="sd">        transforms data to object-oriented data</span>
<span class="sd">        :return: None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FILE</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">PRODUCTLIST</span>
        <span class="n">productList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Open product file and read lines to list.</span>
            <span class="c1"># Avoid u\ufeff prefix in data by set encoding to utf8-8-sig (source: stackoverflow)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">FILE</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8-sig&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
                <span class="nb">list</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
                <span class="c1"># Split the line by &#39;;&#39; to get the id and name</span>
                <span class="n">product_data</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
                <span class="n">product_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">product_data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">product_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">product_data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">productList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Product</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">product_id</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">product_name</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: could&#39;t find product list file &#39;Produkte.db&#39;&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: file &#39;Produkte.db&#39; doesn&#39;t exist&quot;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">productList</span> <span class="o">=</span> <span class="n">productList</span>
    <span class="k">def</span> <span class="nf">__populateViewModels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storageData</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Now since data from StorageData.db and Produkte.db is loaded and transformed, it</span>
<span class="sd">        can be used to populate viewModels storageViewModel.</span>
<span class="sd">        However, for QAbstractTableModel storageData has to be transformed into table struct.</span>

<span class="sd">        :param productList:  list of products from loadData method without product quantity</span>
<span class="sd">        :type productList: list of ProductData objects.</span>

<span class="sd">        :param storageData: product, cup and pallet data stored in storage rack.</span>
<span class="sd">        :type storageData: list of StorageData objects</span>

<span class="sd">        :return None</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># storageData is now a abject oriented data.</span>
        <span class="c1"># to use a TableModel the data must be set in row/col - values</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">tableData</span> <span class="o">=</span> <span class="p">[[</span><span class="kc">None</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">storageData</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">col</span> <span class="o">==</span> <span class="n">element</span><span class="o">.</span><span class="n">col</span> <span class="ow">and</span> <span class="n">row</span> <span class="o">==</span> <span class="n">element</span><span class="o">.</span><span class="n">row</span><span class="p">:</span>
                        <span class="n">tableData</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">isPallet</span><span class="p">,</span> <span class="n">element</span><span class="o">.</span><span class="n">a_CupID</span><span class="p">,</span> <span class="n">element</span><span class="o">.</span><span class="n">a_ProductID</span><span class="p">,</span> <span class="n">element</span><span class="o">.</span><span class="n">a_Name</span><span class="p">,</span>
                                               <span class="n">element</span><span class="o">.</span><span class="n">b_CupID</span><span class="p">,</span> <span class="n">element</span><span class="o">.</span><span class="n">b_ProductID</span><span class="p">,</span> <span class="n">element</span><span class="o">.</span><span class="n">b_Name</span><span class="p">,</span> <span class="n">element</span><span class="o">.</span><span class="n">row</span><span class="p">,</span>
                                               <span class="n">element</span><span class="o">.</span><span class="n">col</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">storageViewModel</span> <span class="o">=</span> <span class="n">StorageViewModel</span><span class="p">(</span><span class="n">storageData</span><span class="o">=</span><span class="n">tableData</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__populateProductlistViewModel</span><span class="p">(</span><span class="n">storageData</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        create sortable and filterable viewModel </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">productSummaryViewModel</span> <span class="o">=</span> <span class="n">ProductSummaryViewModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">productlistViewModel</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__populateProductlistViewModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storageData</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Loop over storageData to calculate existing product quantities.</span>
<span class="sd">        For this the ProductData class from ProductListViewModel is used due to</span>
<span class="sd">        Product doesn&#39;t store quantity information.</span>
<span class="sd">        Then set data to controller&#39;s ProductListViewModel</span>

<span class="sd">        :param productList:  list of products from loadData method</span>
<span class="sd">        :type productList: list of Product objects.</span>
<span class="sd">        :param storageData: product, cup and pallet data stored in storage rack.</span>
<span class="sd">        :type storageData: list of StorageData objects</span>
<span class="sd">        :return: None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">productDataList</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># different to productList due to Product doesn&#39;t contain quantity information (senseless)</span>
        <span class="k">for</span> <span class="n">product</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">productList</span><span class="p">:</span>
            <span class="n">productDataList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ProductData</span><span class="p">(</span><span class="n">product</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">product</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">stock</span> <span class="ow">in</span> <span class="n">storageData</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">product</span> <span class="ow">in</span> <span class="n">productDataList</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">stock</span><span class="o">.</span><span class="n">a_ProductID</span> <span class="o">==</span> <span class="n">product</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                    <span class="n">product</span><span class="o">.</span><span class="n">quantity</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">stock</span><span class="o">.</span><span class="n">b_ProductID</span> <span class="o">==</span> <span class="n">product</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                    <span class="n">product</span><span class="o">.</span><span class="n">quantity</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            </span>
<span class="sd">        productList is used to populate productListViewModel</span>
<span class="sd">            </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">productlistViewModel</span> <span class="o">=</span> <span class="n">ProductListViewModel</span><span class="p">(</span><span class="n">productDataList</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__productFromID</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">Product</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Finds Product object from given id and returns the object.</span>
<span class="sd">        raises ValueError if no product is found</span>

<span class="sd">        :param id: id of Product object that is searched</span>
<span class="sd">        :type id: int</span>
<span class="sd">        :return: Product object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">product</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">productList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">product</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="nb">id</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">product</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Id </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2"> not found!&quot;</span><span class="p">)</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">ÂµPlant Warehouse Management</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html">README</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">Main File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html#module-src.model.DataModel">Data Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html#module-src.controller.invController">Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html#module-src.service.EventlogService">Service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html#module-src.viewmodel.productlistViewModel">ViewModel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../view.html">View</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dialogs.html">Dialogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../constants.html">Constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../datafiles.html">Data Files</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Lennart Schink.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
    </div>

    

    
  </body>
</html>